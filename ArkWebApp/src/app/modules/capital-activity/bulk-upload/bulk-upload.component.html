<div class="bulk-update">
    <div class="header">
        <h2 mat-dialog-title>
            Capital Activity Bulk Upload
        </h2>
        <div>
            <a style="width: 100px; font-size: 2.4rem;"
            class="ag-grid"
            matTooltip="Download template"
            href="../../../../assets/files/templates/CapitalActivityUploadTemplate.xlsx" download="CapitalActivityUploadTemplate.xlsx">
                <mat-icon class="icon-color">download</mat-icon>
            </a>
        </div>
    </div>

    <div *ngIf="isSuccess"
    class="update-msg success"
    >
        {{ updateMsg }}
    </div>
    <div *ngIf="isFailure"
    class="update-msg failure"
    >
        {{ updateMsg }}
    </div>
    <div *ngIf="!isValid"
    class="update-msg failure"
    >
        {{validationErrorMsg}}
    </div>

    <mat-dialog-content>

        <div class="action-header" *ngIf="(invalidRowData.length + bulkRowData.length) === 0">
            <div 
            class="dropzone zone-w"
            appDropzone
                (hovered)="toggleHover($event)"
                (dropped)="onDrop($event)"
                [class.hovering]="isHovering">
                <div>
                    <button mat-icon-button (click)="fileInput.click()">
                        <mat-icon class="icon-color">attach_file</mat-icon>
                    </button>
                </div>
                <input type="file"
                #fileInput
                matTooltip="Upload excel"
                accept=".xlsx,.xls,.csv"
                (change)="fileUpload($event)"
                style="display: none;">
                <p>Click Here or Drop a File</p>
            </div>
    
        </div>

        <ng-container *ngIf="(invalidRowData.length + bulkRowData.length) > 0">
            <ag-grid-angular class="ag-grid ag-theme-alpine"
                [adaptableOptions]="adaptableOptions"
                [gridOptions]="gridOptions"
                [defaultColDef]="defaultColDef"
                [modules]="agGridModules"
                [columnDefs]="columnDefs"
                [rowData]="!isValid ? invalidRowData : bulkRowData"
                [tooltipShowDelay]="tooltipShowDelay"
                [sideBar]="'columns'"
                (adaptableReady)="onAdaptableReady($event)"
            >
            </ag-grid-angular>
        </ng-container>
    </mat-dialog-content>
    
    <mat-dialog-actions align="end">
        <button mat-raised-button color="primary"
        [disabled]="disableSubmit"
        (click)="onSave()">Submit</button>
    
        <button mat-raised-button (click)="closeDialog()">Close</button>
    </mat-dialog-actions>
</div>
