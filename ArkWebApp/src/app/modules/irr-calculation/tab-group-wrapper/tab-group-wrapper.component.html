<div class="parent">

    <mat-tab-group [selectedIndex]="selected.value" (selectedTabChange)="onSubTabChanged($event);" mat-stretch-tabs="false">
        <mat-tab *ngFor="let subtab of subtabs; let index = index" [label]="subtab.displayName"  class="mat-tab-label">

            <ng-template mat-tab-label  >
                        
                <ng-container *ngIf="subtabs[index].status === 'Loading'">
                    <mat-spinner [diameter] = "20"></mat-spinner>
                </ng-container>

                <ng-container *ngIf="subtabs[index].status === 'Failed'">
                    <mat-icon class="failed-refresh" (click)="reRun(index)">error</mat-icon>
                    
                </ng-container>

                &nbsp;

                <span>{{ subtab.displayName }}</span>
                <br>

            </ng-template>

            <app-irr-result 
                *ngIf="subtab.resultType === 'IRR'" 
                style="display: block; height: calc(100vh -205px);"
                (status)="statusReceived($event, index)"
                [calcParams] = "subtab.calcParams | as : IRRCalcParamsInterface"
                [parentTab] = "parentTab | as : ParentTabType"
                [childTabIndex] = "index | as : number"
            ></app-irr-result>

            <app-monthly-returns
                *ngIf="subtab.resultType === 'Monthly Returns'"
                style="display: block; height: calc(100vh -165px);"
                (status)="statusReceived($event, index)"
                [calcParams] = "subtab.calcParams | as : MonthlyReturnsCalcParamsInterface"
                [parentTab] = "parentTab | as : ParentTabType"
                [childTabIndex] = "index | as : number"
            ></app-monthly-returns>


            <app-performance-fee
                *ngIf="subtab.resultType === 'Performance Fees'"
                style="display: block; height: calc(100vh -205px);"
                (status)="statusReceived($event, index)"
                [calcParams] = "subtab.calcParams | as : PerfFeesCalcParamsInterface"
                [parentTab] = "parentTab | as : ParentTabType"
                [childTabIndex] = "index | as : number"
            ></app-performance-fee>


            <app-cash-flows
                *ngIf="subtab.resultType === 'Cashflows'"
                style="display: block; height: calc(100vh -205px);"
                (status)="statusReceived($event, index)"
                [runID] = "subtab.calcParams?.runID"
                [parentTab] = "parentTab | as : ParentTabType"
                [childTabIndex] = "index | as : number"
            ></app-cash-flows>
       </mat-tab>
    </mat-tab-group>

</div>
